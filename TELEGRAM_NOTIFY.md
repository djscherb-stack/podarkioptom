# Уведомления в Telegram при обновлении данных

После обновления данных о производстве (ручная загрузка Excel, загрузка по API, синхронизация из Google Drive) бот может отправить вам в Telegram сообщение с ключевыми показателями.

## Что приходит в сообщении

- Факт обновления и при sync из GDrive — список загруженных файлов.
- **За последний день с данными:** показатели по трём производствам (ЧАЙ, ГРАВИРОВКА, ЛЮМИНАРК) — сборочные цеха в шт/ед.
- **За текущий месяц:** те же показатели за месяц.

## Настройка

### 1. Создать бота в Telegram

1. Откройте [@BotFather](https://t.me/BotFather) в Telegram.
2. Отправьте `/newbot`, придумайте имя и username бота.
3. Скопируйте **токен** (например, `123456789:AAH...`).

### 2. Узнать свой Chat ID

1. Напишите боту любое сообщение (например, «Привет»).
2. Откройте в браузере (подставьте свой токен):
   ```
   https://api.telegram.org/bot<ВАШ_ТОКЕН>/getUpdates
   ```
3. В ответе найдите `"chat":{"id": 123456789}` — это ваш **Chat ID**.

### 3. Переменные окружения

Добавьте на сервере (Render, свой сервер и т.п.) или в `.env` при локальном запуске:

| Переменная | Описание |
|------------|----------|
| `TELEGRAM_BOT_TOKEN` | Токен бота от BotFather |
| `TELEGRAM_CHAT_ID`   | Ваш Chat ID (число или строка) |

Если хотя бы одна переменная не задана, уведомления не отправляются (ошибок не будет).

### Пример на Render

**Environment** → **Environment Variables**:

- `TELEGRAM_BOT_TOKEN` = `123456789:AAH...`
- `TELEGRAM_CHAT_ID` = `987654321`

## Когда отправляется уведомление

- После **ручной загрузки** Excel в интерфейсе.
- После **загрузки по API** (по токену или из Mailparser).
- После **синхронизации из Google Drive**, только если были скачаны **новые** файлы.

Уведомление формируется после перезагрузки данных (`refresh_data()`), поэтому в сообщении уже отражены обновлённые показатели.
