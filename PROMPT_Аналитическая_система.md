# Prompt: Аналитическая система выпуска продукции

## Описание задачи

Создать веб-приложение — аналитическую систему выпуска продукции. Система автоматически обновляется при добавлении новых файлов с данными в папку. Данные загружаются из Excel-файлов с фиксированной структурой.

---

## Структура входных данных (Excel)

Файлы ежедневно добавляются в папку. Структура каждого файла:

| № колонки | Название поля | Описание |
|-----------|---------------|----------|
| 1 | Артикул | Артикул выпускаемой продукции |
| 2 | Вид номенклатуры | Вид номенклатуры |
| 3 | Наименование | Наименование продукции |
| 4 | Количество | Сколько выпущено продукции (шт.) |
| 5 | Дата выпуска | Дата выпуска продукции |
| 6 | Подразделение | Подразделение, которое выпустило продукцию |

**Формат даты**: уточнить (например, DD.MM.YYYY или YYYY-MM-DD)

---

## Функциональные требования

### 1. Загрузка данных

- Приложение читает все Excel-файлы из указанной папки (например, `/data` или `./uploads`)
- Поддерживается формат `.xlsx`
- При добавлении нового файла в папку данные автоматически подтягиваются (через cron, watchdog или перезагрузку)
- Данные из всех файлов агрегируются в единую базу/датасет

---

### 2. Страница «Аналитика по месяцу»

**URL:** `/month` или главная страница

**Элементы интерфейса:**
- **Селектор месяца** — выбор месяца и года (например, «Январь 2025»)
- После выбора месяца отображаются блоки с аналитикой

**Блоки на странице:**

1. **Блоки по подразделениям (сводка за месяц)**
   - Отдельный блок для каждого подразделения (например: «Картон дерев, Елена», «Цех №2» и т.д.)
   - В каждом блоке: **общий объём выпуска за месяц** (сумма по колонке «Количество»)
   - Подразделения определяются автоматически из данных (уникальные значения из колонки 6)

2. **Блок «Детализация по видам номенклатуры»**
   - По каждому подразделению — раскрывающийся (expand/collapse) блок
   - При раскрытии: таблица или список — **вид номенклатуры** + **количество выпущено за месяц**
   - Сортировка: по количеству (убывание) или по названию

---

### 3. Страница «Аналитика по дню»

**URL:** `/day`

**Элементы интерфейса:**
- **Селектор даты** — выбор конкретной даты
- После выбора даты отображаются блоки

**Блоки на странице:**

1. **Блоки по подразделениям за выбранный день**
   - Для каждого подразделения: какие **виды номенклатуры** выпущены и в **каком количестве**
   - Формат: подразделение → список (вид номенклатуры, количество)

2. **Блок сравнения с вчерашним днём**
   - Сравнение выбранного дня с предыдущим днём
   - Метрики для сравнения:
     - Количество **видов номенклатуры** (сколько уникальных видов выпущено)
     - Количество **выпущенных единиц** по каждому виду (или суммарно)
   - Визуализация: таблица или карточки «Сегодня vs Вчера» с дельтой (разница, процент изменения)

---

## Технические требования

- **Backend**: Python (FastAPI/Flask) или Node.js — на твоё усмотрение
- **Frontend**: React, Vue или простой HTML/JS — с современным UI
- **Хранение данных**: SQLite или PostgreSQL для агрегированных данных; либо чтение Excel «на лету» при каждом запросе (если файлов немного)
- **Обработка Excel**: `openpyxl` (Python) или `xlsx` (Node.js)
- **Автообновление при появлении новых файлов**: 
  - вариант 1: cron-задача, раз в N минут сканирует папку и обновляет БД
  - вариант 2: file watcher (watchdog в Python)
  - вариант 3: API-эндпоинт для ручной загрузки файла

---

## Структура приложения (рекомендуемая)

```
ProAnalitik/
├── data/                    # Папка с Excel-файлами (ежедневные загрузки)
│   ├── выпуск_2025-01-15.xlsx
│   └── выпуск_2025-01-16.xlsx
├── backend/                 # API + логика обработки
│   ├── app.py
│   ├── parser.py            # Парсинг Excel
│   ├── models.py            # Модели данных
│   └── requirements.txt
├── frontend/                # UI
│   └── ...
└── README.md
```

---

## API (предлагаемые эндпоинты)

| Метод | Путь | Описание |
|-------|------|----------|
| GET | `/api/departments` | Список всех подразделений |
| GET | `/api/month/{year}/{month}` | Агрегированная аналитика за месяц |
| GET | `/api/day/{date}` | Аналитика за день + сравнение с предыдущим днём |
| POST | `/api/refresh` | Принудительное обновление данных из папки |

---

## UI/UX

- Чистый, читаемый интерфейс
- Адаптивность под десктоп и планшет
- Селекторы месяца/даты — удобные date/month picker
- Раскрывающиеся блоки — плавная анимация
- Таблицы с возможностью сортировки по колонкам

---

## Дополнительные уточнения (если нужно)

1. Формат даты в Excel (DD.MM.YYYY, YYYY-MM-DD и т.д.)
2. Кодировка и разделитель в Excel (если будет CSV)
3. Нужна ли авторизация пользователей
4. Нужен ли экспорт отчётов в Excel/PDF

---

## Краткая сводка для копирования в AI

> Создай аналитический веб-сайт выпуска продукции. Данные приходят из Excel-файлов в папку (колонки: артикул, вид номенклатуры, наименование, количество, дата выпуска, подразделение). Две страницы: (1) по месяцу — селектор месяца, блоки по подразделениям с общим выпуском за месяц, раскрываемая детализация по видам номенклатуры; (2) по дню — селектор даты, аналитика по подразделениям за день, сравнение с вчерашним днём по количеству видов номенклатуры и объёмам. Backend на Python (FastAPI) + парсинг Excel (openpyxl), frontend на React. Папка с файлами сканируется и обновляет данные при добавлении новых файлов.
