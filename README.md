# Аналитика выпуска продукции

Веб-приложение для анализа выпуска продукции по данным из Excel-файлов.

**Развёртывание в интернете:** см. [DEPLOY.md](DEPLOY.md)

## Структура данных (Excel)

| Колонка | Поле |
|---------|------|
| 1 | Артикул продукции |
| 2 | Вид номенклатуры |
| 3 | Наименование продукции |
| 4 | Количество выпущено |
| 5 | Дата выпуска |
| 6 | Подразделение |

Поддерживаются файлы с заголовками 1С (например, «Продукция.Номенклатура.Артикул»).

## Запуск

### 1. Подготовка

```bash
# Создать виртуальное окружение (если ещё нет)
python3 -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# Установить зависимости
pip install -r backend/requirements.txt
```

### 2. Размещение данных

Положите Excel-файлы (.xlsx) в:
- папку `data/` или
- корень проекта `ProAnalitik/`

### 3. Запуск сервера

```bash
source venv/bin/activate
cd backend && uvicorn app:app --reload --host 0.0.0.0 --port 8000
```

Откройте http://localhost:8000

### Режим разработки (frontend + backend)

**Терминал 1 — backend:**
```bash
source venv/bin/activate
cd backend && uvicorn app:app --reload --port 8000
```

**Терминал 2 — frontend:**
```bash
cd frontend && npm run dev
```

Откройте http://localhost:5173 (Vite проксирует `/api` на backend)

## Страницы

- **По месяцу** — выбор месяца, блоки по подразделениям с общим выпуском, раскрываемая детализация по видам номенклатуры
- **По дню** — выбор даты, аналитика по подразделениям, сравнение с вчерашним днём (виды номенклатуры и объёмы)

## Обновление данных

При добавлении новых файлов в папку нажмите кнопку ⟳ «Обновить» на странице — данные перезагрузятся из всех Excel-файлов.

## API

| Метод | URL | Описание |
|-------|-----|----------|
| GET | /api/refresh | Перезагрузить данные из папки |
| GET | /api/months | Список месяцев с данными |
| GET | /api/month/{year}/{month} | Аналитика за месяц |
| GET | /api/day/{YYYY-MM-DD} | Аналитика за день + сравнение с вчера |
